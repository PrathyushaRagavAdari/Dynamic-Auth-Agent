# Dynamic-Auth-Agent
Data Science Capstone Project

Team: Dynamic Agents

Members:

Prathyu Adari
16371669

Role: Product Intelligence, Strategy & Insight Lead

Krutarth Lad

Role: The Systems, Data Architecture, ML & Pipeline Lead


# Week 3 Sprint: Multimodal Compliance RAG for GraphGuard

## 1. Product Brief

**Feature Name:** GraphGuard Compliance Audit Assistant

**Objective:** To enable internal risk officers to verify that the dynamic security questions generated by GraphGuard comply with federal identity guidelines (NIST 800-63B) and banking regulations.

**Problem Solved:** GraphGuard generates infinite unique questions. We need an automated way to check if a generated question (e.g., *"Select your transaction from 3 weeks ago"*) aligns with legal authentication assurance levels (AAL).

---

## 2. System Architecture

We implemented a **Hybrid Multimodal RAG** system to handle both text-heavy regulations and visual flowcharts found in banking policy documents.

* **Ingestion Layer:**
* **PDF Parsing:** `PyMuPDFLoader` for high-speed text extraction.
* **Visual Parsing:** Simulated Vision-Language Model (VLM) captioning for capturing data in the "AAL Requirements" table.
* **Chunking:** Recursive Character Splitter (1000 tokens, 100 overlap).


* **Retrieval Layer (Hybrid):**
* **Dense Search:** `sentence-transformers/all-MiniLM-L6-v2` (Hugging Face) stored in FAISS. Captures semantic meaning.
* **Sparse Search:** BM25 (Rank-BM25). Captures specific regulatory keywords (e.g., "AAL3", "CSP").
* **Fusion:** `EnsembleRetriever` with a 60/40 weight favoring semantic search.


* **Generation Layer:**
* **LLM:** `Mistral-7B-Instruct` (via Hugging Face Endpoint).
* **Prompt Engineering:** Strict system prompt enforcing "I do not have enough evidence" for out-of-domain queries.



---

## 3. Data Inventory

| Source | Modality | Role in Product | Status |
| --- | --- | --- | --- |
| **NIST SP 800-63B** | Text (PDF) | The "Ground Truth" for digital identity guidelines. | ✅ Ingested |
| **FCRA** | Text (PDF) | The Fair Credit Reporting ACT. | ✅ Ingested |
| **PCI** | Text (PDF) | The Payment Card Industry Data Security Standard. | ✅ Ingested |
| **AAL Requirements and Other Images** | Image/Chart | Critical lookup tables for authentication assurance levels. | ✅ Ingested via OCR |

---

## 4. Evaluation & Results

We evaluated the system on 3 core tasks: **Visual QA**, **Text QA**, and **Refusal**.

### A. Performance Metrics (Automated)

Based on a test set of 3 regulatory queries against the Knowledge Base.

| Metric | Value | Description |
| --- | --- | --- |
| **Avg Latency** | **1.77s** | Fast enough for real-time audit workflows (Goal < 3s). |
| **Precision@5** | **0.80** | 80% of retrieved chunks were relevant to the query. |
| **Recall@5** | **1.00** | The system found the correct answer 100% of the time. |
| **Faithfulness** | **100%** | No hallucinations detected; answers matched ground truth keywords. |

### B. Ablation Study (Text-Only vs. Multimodal)

We compared a standard Text-RAG against our Multimodal implementation.

| Task | User Query | Text-Only Result | Hybrid Multimodal Result | Decision |
| --- | --- | --- | --- | --- |
| **1. Visual Data** | *"Requirements for AAL3?"* | **Fail.** (Could not read the table image). | **Pass.** (Correctly cited "Hardware-based authenticator"). | **Ship Multimodal** |
| **2. Keyword** | *"Define Credential CSP"* | **Pass.** | **Pass.** (BM25 aided specific term retrieval). | **Ship Hybrid** |
| **3. Safety** | *"How to bake a cake?"* | **Pass.** (Refused). | **Pass.** (Refused: "I do not have enough evidence"). | **Ship** |

---

## 5. Failure Analysis & Risk Strategy

* **Observed Failure:** In early testing, the specific chunk containing "AAL2 requirements" was ranked #6, missing the context window when `k=5`.
* **Organizational Risk:** If the Auditor receives an incomplete list of requirements, they might approve a non-compliant security question, risking regulatory fines.
* **Mitigation Strategy:**
1. **Algorithmic:** Increased retrieval `k` to 7 to broaden context capture.
2. **UX:** Added a "Source Citation" footer so the human auditor can click the link to the original NIST PDF page to verify the full context.



## 6. Deployment Plan ("If we shipped this")

To move this from Colab to Production:

1. **Vector DB:** Migrate from local FAISS to **Pinecone** for persistent storage.
2. **Model:** Upgrade from Mistral-7B to **Llama-3-70B** for better reasoning on complex "gray area" compliance questions.
3. **Interface:** Build a Streamlit dashboard where Compliance Officers can upload new policy PDFs without coding.
